import requests
import urllib.parse
import time

def puxar_dados_nome(nome, tentativas=5):
    base_url = "https://777apisss.vercel.app/nome/completo2/"
    api_key = "firminoh7778"
    query = urllib.parse.quote(nome)
    url = f"{base_url}?query={query}&apikey={api_key}"

    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 "
                      "(KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36",
        "Accept": "*/*",
        "Connection": "keep-alive"
    }

    for tentativa in range(1, tentativas + 1):
        print(f"\nüîÅ Tentativa {tentativa}/{tentativas} - Buscando: {nome}")
        try:
            resposta = requests.get(url, headers=headers, timeout=15)
            print(f"üì° Status HTTP: {resposta.status_code}")

            # For√ßa encoding correto
            resposta.encoding = resposta.apparent_encoding

            # Se for JSON v√°lido
            try:
                dados = resposta.json()
                print("‚úÖ JSON recebido:")
                for chave, valor in dados.items():
                    print(f"  - {chave}: {valor}")
                return
            except Exception:
                print("‚ö†Ô∏è N√£o veio JSON. Mostrando texto cru:")
                print(resposta.text[:1000])  # Mostra at√© 1000 caracteres

        except requests.exceptions.Timeout:
            print("‚è∞ Timeout! A API demorou demais pra responder.")
        except requests.exceptions.ConnectionError:
            print("üîå Erro de conex√£o. Verifique sua internet ou a API.")
        except Exception as e:
            print(f"‚ùå Erro inesperado: {e}")

        time.sleep(2)  # Aguarda antes da pr√≥xima tentativa

    print("‚ùó Todas as tentativas falharam.")

if __name__ == "__main__":
    try:
        nome = input("üìù Digite o nome completo para busca: ").strip()
        if nome:
            puxar_dados_nome(nome)
        else:
            print("‚ö†Ô∏è Nome inv√°lido.")
    except KeyboardInterrupt:
        print("\n‚ùå Encerrado pelo usu√°rio.")
